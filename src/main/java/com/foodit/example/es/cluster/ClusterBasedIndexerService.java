package com.foodit.example.es.cluster;import com.foodit.example.es.IndexerService;import com.foodit.example.util.Properties;import com.google.gson.JsonObject;import org.elasticsearch.action.index.IndexResponse;import org.elasticsearch.client.Client;import org.elasticsearch.client.transport.TransportClient;import org.elasticsearch.common.settings.ImmutableSettings;import org.elasticsearch.common.settings.Settings;import org.elasticsearch.common.transport.InetSocketTransportAddress;import java.util.Map;public class ClusterBasedIndexerService implements IndexerService {    Settings settings = ImmutableSettings.settingsBuilder()            .put("cluster.name", "elasticsearch")            .build();    Client client = new TransportClient(settings)            .addTransportAddress(new InetSocketTransportAddress("localhost", 9300));    public String indexDocument(String documentId, Map<String, String> properties) {        JsonObject jsonDocument = new JsonObject();        for(Map.Entry<String, String> entry : properties.entrySet()) {            jsonDocument.addProperty(entry.getKey(), entry.getValue());;        }        jsonDocument.addProperty("id", documentId);        IndexResponse response = client                .prepareIndex(Properties.INDEX_NAME, Properties.TYPE_NAME)                .setSource(jsonDocument.toString())                .execute()                .actionGet();        return response.toString();    }}